[["day-2-data-manipulation-and-visualization-in-r.html", "2 Day-2 : Data Manipulation and Visualization in R 2.1 Learning Objectives 2.2 Introduction to the Tidyverse 2.3 Installing and Loading Packages 2.4 Tidy Data Principles 2.5 The Pipe Operator (%&gt;%) 2.6 Data Manipulation with dplyr 2.7 Joins 2.8 Introduction to ggplot2 2.9 Exploratory Data Analysis (EDA) 2.10 Hands-on Exercises", " 2 Day-2 : Data Manipulation and Visualization in R 2.1 Learning Objectives By the end of this day, students will be able to: Understand tidy data principles Use dplyr for data manipulation Create publication-quality plots using ggplot2 Work efficiently with real-world datasets Perform basic exploratory data analysis (EDA) 2.2 Introduction to the Tidyverse The tidyverse is a collection of R packages designed for: Data manipulation Data visualization Data analysis workflows Core tidyverse packages include: ggplot2 – data visualization dplyr – data manipulation tidyr – data reshaping readr – data import tibble – modern data frames stringr – string manipulation forcats – categorical data handling lubridate - makes it easier to work with dates and times readxl - data import * note: readxl is not loaded automatically with library(tidyverse) 2.3 Installing and Loading Packages Install packages (only once): # install.packages(&quot;tidyverse&quot;) Load packages (before every session): library(tidyverse) ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ── ## ✔ dplyr 1.1.4 ✔ readr 2.1.6 ## ✔ forcats 1.0.1 ✔ stringr 1.6.0 ## ✔ ggplot2 4.0.1 ✔ tibble 3.3.1 ## ✔ lubridate 1.9.4 ✔ tidyr 1.3.2 ## ✔ purrr 1.2.1 ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ── ## ✖ dplyr::filter() masks stats::filter() ## ✖ dplyr::lag() masks stats::lag() ## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors 2.4 Tidy Data Principles A dataset is tidy if: Each variable is a column Each observation is a row Each value is a cell These principles make data easier to manipulate, visualize and analyze. 2.4.1 Working with a Real Dataset We will use the built-in iris dataset. head(iris) ## Sepal.Length Sepal.Width Petal.Length Petal.Width Species ## 1 5.1 3.5 1.4 0.2 setosa ## 2 4.9 3.0 1.4 0.2 setosa ## 3 4.7 3.2 1.3 0.2 setosa ## 4 4.6 3.1 1.5 0.2 setosa ## 5 5.0 3.6 1.4 0.2 setosa ## 6 5.4 3.9 1.7 0.4 setosa str(iris) ## &#39;data.frame&#39;: 150 obs. of 5 variables: ## $ Sepal.Length: num 5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ... ## $ Sepal.Width : num 3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ... ## $ Petal.Length: num 1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ... ## $ Petal.Width : num 0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ... ## $ Species : Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1 1 1 1 1 1 1 1 ... 2.5 The Pipe Operator (%&gt;%) When working with the tidyverse, we often perform multiple operations in sequence. The pipe operator (%&gt;%) allows us to write these steps in a clear and readable way. The pipe takes the output of one step and passes it as the input to the next step. You can read %&gt;% as “and then”, which helps in understanding the flow of the code. Without the pipe iris[1:6, c(&quot;Sepal.Length&quot;, &quot;Sepal.Width&quot;)] ## Sepal.Length Sepal.Width ## 1 5.1 3.5 ## 2 4.9 3.0 ## 3 4.7 3.2 ## 4 4.6 3.1 ## 5 5.0 3.6 ## 6 5.4 3.9 with pipe iris %&gt;% select(Sepal.Length, Sepal.Width) %&gt;% head() ## Sepal.Length Sepal.Width ## 1 5.1 3.5 ## 2 4.9 3.0 ## 3 4.7 3.2 ## 4 4.6 3.1 ## 5 5.0 3.6 ## 6 5.4 3.9 The pipe allows code to be read from top to bottom, similar to a workflow. 2.6 Data Manipulation with dplyr Note: Most tidyverse functions assume that data is already in tidy format. Selecting Columns, no need to write “” when writing name of columns iris %&gt;% select(Sepal.Length, Sepal.Width) %&gt;% head(10) ## Sepal.Length Sepal.Width ## 1 5.1 3.5 ## 2 4.9 3.0 ## 3 4.7 3.2 ## 4 4.6 3.1 ## 5 5.0 3.6 ## 6 5.4 3.9 ## 7 4.6 3.4 ## 8 5.0 3.4 ## 9 4.4 2.9 ## 10 4.9 3.1 Exclude columns: iris %&gt;% select(-Species) %&gt;% head() ## Sepal.Length Sepal.Width Petal.Length Petal.Width ## 1 5.1 3.5 1.4 0.2 ## 2 4.9 3.0 1.4 0.2 ## 3 4.7 3.2 1.3 0.2 ## 4 4.6 3.1 1.5 0.2 ## 5 5.0 3.6 1.4 0.2 ## 6 5.4 3.9 1.7 0.4 Filtering Rows iris %&gt;% filter(Species == &quot;setosa&quot;) %&gt;% head() ## Sepal.Length Sepal.Width Petal.Length Petal.Width Species ## 1 5.1 3.5 1.4 0.2 setosa ## 2 4.9 3.0 1.4 0.2 setosa ## 3 4.7 3.2 1.3 0.2 setosa ## 4 4.6 3.1 1.5 0.2 setosa ## 5 5.0 3.6 1.4 0.2 setosa ## 6 5.4 3.9 1.7 0.4 setosa Multiple conditions: iris %&gt;% filter(Sepal.Length &gt; 5, Species == &quot;virginica&quot;) %&gt;% head() ## Sepal.Length Sepal.Width Petal.Length Petal.Width Species ## 1 6.3 3.3 6.0 2.5 virginica ## 2 5.8 2.7 5.1 1.9 virginica ## 3 7.1 3.0 5.9 2.1 virginica ## 4 6.3 2.9 5.6 1.8 virginica ## 5 6.5 3.0 5.8 2.2 virginica ## 6 7.6 3.0 6.6 2.1 virginica Creating New Variables (mutate) iris %&gt;% mutate( Sepal.Area = Sepal.Length * Sepal.Width ) %&gt;% head() ## Sepal.Length Sepal.Width Petal.Length Petal.Width Species Sepal.Area ## 1 5.1 3.5 1.4 0.2 setosa 17.85 ## 2 4.9 3.0 1.4 0.2 setosa 14.70 ## 3 4.7 3.2 1.3 0.2 setosa 15.04 ## 4 4.6 3.1 1.5 0.2 setosa 14.26 ## 5 5.0 3.6 1.4 0.2 setosa 18.00 ## 6 5.4 3.9 1.7 0.4 setosa 21.06 Sorting Data (arrange) ascending: iris %&gt;% arrange(Sepal.Length)%&gt;% head() ## Sepal.Length Sepal.Width Petal.Length Petal.Width Species ## 1 4.3 3.0 1.1 0.1 setosa ## 2 4.4 2.9 1.4 0.2 setosa ## 3 4.4 3.0 1.3 0.2 setosa ## 4 4.4 3.2 1.3 0.2 setosa ## 5 4.5 2.3 1.3 0.3 setosa ## 6 4.6 3.1 1.5 0.2 setosa descending iris %&gt;% arrange(desc(Sepal.Length))%&gt;% head() ## Sepal.Length Sepal.Width Petal.Length Petal.Width Species ## 1 7.9 3.8 6.4 2.0 virginica ## 2 7.7 3.8 6.7 2.2 virginica ## 3 7.7 2.6 6.9 2.3 virginica ## 4 7.7 2.8 6.7 2.0 virginica ## 5 7.7 3.0 6.1 2.3 virginica ## 6 7.6 3.0 6.6 2.1 virginica Summarizing Data (summarise) iris %&gt;% summarise( mean_sepal_length = mean(Sepal.Length), sd_sepal_length = sd(Sepal.Length) ) ## mean_sepal_length sd_sepal_length ## 1 5.843333 0.8280661 Grouped Operations (group_by) This allow us to perform summaries separately for each group in the data. iris %&gt;% group_by(Species) %&gt;% summarise( mean_sepal_length = mean(Sepal.Length), mean_petal_length = mean(Petal.Length) ) ## # A tibble: 3 × 3 ## Species mean_sepal_length mean_petal_length ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 setosa 5.01 1.46 ## 2 versicolor 5.94 4.26 ## 3 virginica 6.59 5.55 rename() — Rename Columns Used to make column names shorter or more meaningful. iris %&gt;% rename( SL = Sepal.Length, SW = Sepal.Width ) %&gt;% head() ## SL SW Petal.Length Petal.Width Species ## 1 5.1 3.5 1.4 0.2 setosa ## 2 4.9 3.0 1.4 0.2 setosa ## 3 4.7 3.2 1.3 0.2 setosa ## 4 4.6 3.1 1.5 0.2 setosa ## 5 5.0 3.6 1.4 0.2 setosa ## 6 5.4 3.9 1.7 0.4 setosa distinct() — Keep Unique Rows Used to remove duplicate rows or extract unique values. iris %&gt;% distinct(Species) ## Species ## 1 setosa ## 2 versicolor ## 3 virginica iris %&gt;% distinct(Species, Sepal.Length) ## Species Sepal.Length ## 1 setosa 5.1 ## 2 setosa 4.9 ## 3 setosa 4.7 ## 4 setosa 4.6 ## 5 setosa 5.0 ## 6 setosa 5.4 ## 7 setosa 4.4 ## 8 setosa 4.8 ## 9 setosa 4.3 ## 10 setosa 5.8 ## 11 setosa 5.7 ## 12 setosa 5.2 ## 13 setosa 5.5 ## 14 setosa 4.5 ## 15 setosa 5.3 ## 16 versicolor 7.0 ## 17 versicolor 6.4 ## 18 versicolor 6.9 ## 19 versicolor 5.5 ## 20 versicolor 6.5 ## 21 versicolor 5.7 ## 22 versicolor 6.3 ## 23 versicolor 4.9 ## 24 versicolor 6.6 ## 25 versicolor 5.2 ## 26 versicolor 5.0 ## 27 versicolor 5.9 ## 28 versicolor 6.0 ## 29 versicolor 6.1 ## 30 versicolor 5.6 ## 31 versicolor 6.7 ## 32 versicolor 5.8 ## 33 versicolor 6.2 ## 34 versicolor 6.8 ## 35 versicolor 5.4 ## 36 versicolor 5.1 ## 37 virginica 6.3 ## 38 virginica 5.8 ## 39 virginica 7.1 ## 40 virginica 6.5 ## 41 virginica 7.6 ## 42 virginica 4.9 ## 43 virginica 7.3 ## 44 virginica 6.7 ## 45 virginica 7.2 ## 46 virginica 6.4 ## 47 virginica 6.8 ## 48 virginica 5.7 ## 49 virginica 7.7 ## 50 virginica 6.0 ## 51 virginica 6.9 ## 52 virginica 5.6 ## 53 virginica 6.2 ## 54 virginica 6.1 ## 55 virginica 7.4 ## 56 virginica 7.9 ## 57 virginica 5.9 slice() — Select Rows by Position Used when you want rows based on row numbers, not conditions. iris %&gt;% slice(1:5) ## Sepal.Length Sepal.Width Petal.Length Petal.Width Species ## 1 5.1 3.5 1.4 0.2 setosa ## 2 4.9 3.0 1.4 0.2 setosa ## 3 4.7 3.2 1.3 0.2 setosa ## 4 4.6 3.1 1.5 0.2 setosa ## 5 5.0 3.6 1.4 0.2 setosa iris %&gt;% slice((n() - 4):n()) ## Sepal.Length Sepal.Width Petal.Length Petal.Width Species ## 1 6.7 3.0 5.2 2.3 virginica ## 2 6.3 2.5 5.0 1.9 virginica ## 3 6.5 3.0 5.2 2.0 virginica ## 4 6.2 3.4 5.4 2.3 virginica ## 5 5.9 3.0 5.1 1.8 virginica pull() — Extract a Column as a Vector Converts a data frame column into a plain vector. species_vec &lt;- iris %&gt;% pull(Species) species_vec ## [1] setosa setosa setosa setosa setosa setosa ## [7] setosa setosa setosa setosa setosa setosa ## [13] setosa setosa setosa setosa setosa setosa ## [19] setosa setosa setosa setosa setosa setosa ## [25] setosa setosa setosa setosa setosa setosa ## [31] setosa setosa setosa setosa setosa setosa ## [37] setosa setosa setosa setosa setosa setosa ## [43] setosa setosa setosa setosa setosa setosa ## [49] setosa setosa versicolor versicolor versicolor versicolor ## [55] versicolor versicolor versicolor versicolor versicolor versicolor ## [61] versicolor versicolor versicolor versicolor versicolor versicolor ## [67] versicolor versicolor versicolor versicolor versicolor versicolor ## [73] versicolor versicolor versicolor versicolor versicolor versicolor ## [79] versicolor versicolor versicolor versicolor versicolor versicolor ## [85] versicolor versicolor versicolor versicolor versicolor versicolor ## [91] versicolor versicolor versicolor versicolor versicolor versicolor ## [97] versicolor versicolor versicolor versicolor virginica virginica ## [103] virginica virginica virginica virginica virginica virginica ## [109] virginica virginica virginica virginica virginica virginica ## [115] virginica virginica virginica virginica virginica virginica ## [121] virginica virginica virginica virginica virginica virginica ## [127] virginica virginica virginica virginica virginica virginica ## [133] virginica virginica virginica virginica virginica virginica ## [139] virginica virginica virginica virginica virginica virginica ## [145] virginica virginica virginica virginica virginica virginica ## Levels: setosa versicolor virginica sample_n() — Randomly Sample Rows Randomly select a fixed number of rows. iris %&gt;% sample_n(10) ## Sepal.Length Sepal.Width Petal.Length Petal.Width Species ## 1 6.5 3.2 5.1 2.0 virginica ## 2 6.3 2.7 4.9 1.8 virginica ## 3 5.6 2.5 3.9 1.1 versicolor ## 4 6.1 2.9 4.7 1.4 versicolor ## 5 6.5 2.8 4.6 1.5 versicolor ## 6 5.0 3.4 1.6 0.4 setosa ## 7 6.8 3.0 5.5 2.1 virginica ## 8 5.7 3.8 1.7 0.3 setosa ## 9 5.4 3.9 1.7 0.4 setosa ## 10 6.1 2.6 5.6 1.4 virginica sample_frac() — Sample a Fraction of Rows Randomly select a fraction of the dataset. iris %&gt;% sample_frac(0.1) # 10% of the data ## Sepal.Length Sepal.Width Petal.Length Petal.Width Species ## 1 5.6 2.5 3.9 1.1 versicolor ## 2 5.4 3.7 1.5 0.2 setosa ## 3 6.4 2.9 4.3 1.3 versicolor ## 4 5.1 3.5 1.4 0.2 setosa ## 5 6.1 2.8 4.0 1.3 versicolor ## 6 5.5 2.4 3.7 1.0 versicolor ## 7 4.9 3.6 1.4 0.1 setosa ## 8 6.3 2.7 4.9 1.8 virginica ## 9 5.8 4.0 1.2 0.2 setosa ## 10 6.4 3.2 5.3 2.3 virginica ## 11 5.5 2.3 4.0 1.3 versicolor ## 12 7.3 2.9 6.3 1.8 virginica ## 13 7.7 3.8 6.7 2.2 virginica ## 14 7.2 3.6 6.1 2.5 virginica ## 15 6.0 2.9 4.5 1.5 versicolor 2.7 Joins Joining datasets is common in biology (samples + metadata # Example datasets df1 &lt;- tibble(ID = 1:3, Value = c(10,20,30)) df2 &lt;- tibble(ID = 2:4, Group = c(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;)) # Inner join inner_join(df1, df2, by = &quot;ID&quot;) ## # A tibble: 2 × 3 ## ID Value Group ## &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 2 20 A ## 2 3 30 B # Left join left_join(df1, df2, by = &quot;ID&quot;) ## # A tibble: 3 × 3 ## ID Value Group ## &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 1 10 &lt;NA&gt; ## 2 2 20 A ## 3 3 30 B # right join right_join(df1, df2, by = &quot;ID&quot;) ## # A tibble: 3 × 3 ## ID Value Group ## &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 2 20 A ## 2 3 30 B ## 3 4 NA C # full join df &lt;- full_join(df1, df2, by = &quot;ID&quot;) df %&gt;% drop_na() # removing all nas dplyr function ## # A tibble: 2 × 3 ## ID Value Group ## &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 2 20 A ## 2 3 30 B # drop by condition df %&gt;% filter(!is.na(Value)) ## # A tibble: 3 × 3 ## ID Value Group ## &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 1 10 &lt;NA&gt; ## 2 2 20 A ## 3 3 30 B df %&gt;% filter(!is.na(Group)) ## # A tibble: 3 × 3 ## ID Value Group ## &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 2 20 A ## 2 3 30 B ## 3 4 NA C df %&gt;% filter(!is.na(Group) | !is.na(Value)) ## # A tibble: 4 × 3 ## ID Value Group ## &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 1 10 &lt;NA&gt; ## 2 2 20 A ## 3 3 30 B ## 4 4 NA C df %&gt;% filter(!is.na(Group) &amp; !is.na(Value)) ## # A tibble: 2 × 3 ## ID Value Group ## &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 2 20 A ## 2 3 30 B 2.7.1 Reshaping Data (tidyr) library(tidyr) library(tibble) gene_expression_wide &lt;- tibble( Gene = c(&quot;BRCA1&quot;, &quot;TP53&quot;, &quot;EGFR&quot;), Sample_A = c(12.5, 8.3, 15.2), Sample_B = c(13.1, 9.0, 14.8), Sample_C = c(11.9, 8.7, 16.0) ) gene_expression_wide ## # A tibble: 3 × 4 ## Gene Sample_A Sample_B Sample_C ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 BRCA1 12.5 13.1 11.9 ## 2 TP53 8.3 9 8.7 ## 3 EGFR 15.2 14.8 16 # Each row = a gene # Each column = a sample # This is easy for humans to read but not tidy. # Wideto Long (Tidy Format) # Convert sample columns into rows using pivot_longer(). gene_expression_long &lt;- gene_expression_wide %&gt;% pivot_longer( cols = starts_with(&quot;Sample&quot;), names_to = &quot;Sample&quot;, values_to = &quot;Expression&quot; ) gene_expression_long ## # A tibble: 9 × 3 ## Gene Sample Expression ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 BRCA1 Sample_A 12.5 ## 2 BRCA1 Sample_B 13.1 ## 3 BRCA1 Sample_C 11.9 ## 4 TP53 Sample_A 8.3 ## 5 TP53 Sample_B 9 ## 6 TP53 Sample_C 8.7 ## 7 EGFR Sample_A 15.2 ## 8 EGFR Sample_B 14.8 ## 9 EGFR Sample_C 16 # easy inetegration with ggplot format ggplot(gene_expression_long, aes(x = Sample, y = Expression, fill = Gene)) + geom_col(position = &quot;dodge&quot;) + labs( title = &quot;Gene Expression Across Samples&quot;, y = &quot;Expression Level&quot; ) # Long to Wide (When Needed) # Sometimes, you need to go back to wide format (e.g., for export or specific tools). gene_expression_wide_again &lt;- gene_expression_long %&gt;% pivot_wider( names_from = Sample, values_from = Expression ) gene_expression_wide_again ## # A tibble: 3 × 4 ## Gene Sample_A Sample_B Sample_C ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 BRCA1 12.5 13.1 11.9 ## 2 TP53 8.3 9 8.7 ## 3 EGFR 15.2 14.8 16 # time dependent data time_course &lt;- tibble( Gene = c(&quot;MYC&quot;, &quot;MYC&quot;, &quot;MYC&quot;, &quot;TP53&quot;, &quot;TP53&quot;, &quot;TP53&quot;, &quot;EGFR&quot;, &quot;EGFR&quot;, &quot;EGFR&quot;), Time = c(&quot;0h&quot;, &quot;6h&quot;, &quot;12h&quot;, &quot;0h&quot;, &quot;6h&quot;, &quot;12h&quot;, &quot;0h&quot;, &quot;6h&quot;, &quot;12h&quot;), Expression = c( 5.2, 8.1, 12.4, # MYC 7.5, 6.8, 5.9, # TP53 10.1, 12.3, 14.8 # EGFR ) ) time_course ## # A tibble: 9 × 3 ## Gene Time Expression ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 MYC 0h 5.2 ## 2 MYC 6h 8.1 ## 3 MYC 12h 12.4 ## 4 TP53 0h 7.5 ## 5 TP53 6h 6.8 ## 6 TP53 12h 5.9 ## 7 EGFR 0h 10.1 ## 8 EGFR 6h 12.3 ## 9 EGFR 12h 14.8 time_course %&gt;% pivot_wider( names_from = Time, values_from = Expression ) ## # A tibble: 3 × 4 ## Gene `0h` `6h` `12h` ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 MYC 5.2 8.1 12.4 ## 2 TP53 7.5 6.8 5.9 ## 3 EGFR 10.1 12.3 14.8 ggplot(time_course, aes(x = Time, y = Expression, color = Gene, group = Gene)) + geom_line() + geom_point() + labs( title = &quot;Gene Expression Time Course&quot;, y = &quot;Expression Level&quot; ) When Column Names Are Badly Named Suppose the dataset came from an external source with inconsistent naming: gene_expression_bad &lt;- tibble( `Gene ID` = c(&quot;BRCA1&quot;, &quot;TP53&quot;, &quot;EGFR&quot;), `Sample A (day 0)` = c(12.5, 8.3, 15.2), `Sample-B day6` = c(13.1, 9.0, 14.8), `sample_c_day_12` = c(11.9, 8.7, 16.0) ) gene_expression_bad ## # A tibble: 3 × 4 ## `Gene ID` `Sample A (day 0)` `Sample-B day6` sample_c_day_12 ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 BRCA1 12.5 13.1 11.9 ## 2 TP53 8.3 9 8.7 ## 3 EGFR 15.2 14.8 16 # Problems: # Spaces and special characters # Inconsistent capitalization # Hard to use in code # Cleaning Column Names (Recommended Workflow) # Rename Manually Using rename() gene_expression_clean &lt;- gene_expression_bad %&gt;% rename( Gene = `Gene ID`, Sample_A = `Sample A (day 0)`, Sample_B = `Sample-B day6`, Sample_C = `sample_c_day_12` ) gene_expression_clean ## # A tibble: 3 × 4 ## Gene Sample_A Sample_B Sample_C ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 BRCA1 12.5 13.1 11.9 ## 2 TP53 8.3 9 8.7 ## 3 EGFR 15.2 14.8 16 # Use this when: # Dataset is small # You want full control over names # Clean Names Automatically (Common in Practice) library(janitor) ## ## Attaching package: &#39;janitor&#39; ## The following objects are masked from &#39;package:stats&#39;: ## ## chisq.test, fisher.test gene_expression_auto &lt;- gene_expression_bad %&gt;% janitor::clean_names() gene_expression_auto ## # A tibble: 3 × 4 ## gene_id sample_a_day_0 sample_b_day6 sample_c_day_12 ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 BRCA1 12.5 13.1 11.9 ## 2 TP53 8.3 9 8.7 ## 3 EGFR 15.2 14.8 16 Converting Columns to Rows (Wide → Long) gene_expression_wide &lt;- tibble( Gene = c(&quot;BRCA1&quot;, &quot;TP53&quot;, &quot;EGFR&quot;), Sample_A = c(12.5, 8.3, 15.2), Sample_B = c(13.1, 9.0, 14.8), Sample_C = c(11.9, 8.7, 16.0) ) gene_expression_wide ## # A tibble: 3 × 4 ## Gene Sample_A Sample_B Sample_C ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 BRCA1 12.5 13.1 11.9 ## 2 TP53 8.3 9 8.7 ## 3 EGFR 15.2 14.8 16 # Step 1: Convert to Matrix (Required for Transpose) # Transposition works on matrices, not tibbles. expr_matrix &lt;- gene_expression_wide %&gt;% column_to_rownames(&quot;Gene&quot;) %&gt;% as.matrix() expr_matrix ## Sample_A Sample_B Sample_C ## BRCA1 12.5 13.1 11.9 ## TP53 8.3 9.0 8.7 ## EGFR 15.2 14.8 16.0 expr_matrix_t &lt;- t(expr_matrix) expr_matrix_t ## BRCA1 TP53 EGFR ## Sample_A 12.5 8.3 15.2 ## Sample_B 13.1 9.0 14.8 ## Sample_C 11.9 8.7 16.0 expr_df &lt;- as.data.frame(expr_matrix_t) expr_df ## BRCA1 TP53 EGFR ## Sample_A 12.5 8.3 15.2 ## Sample_B 13.1 9.0 14.8 ## Sample_C 11.9 8.7 16.0 # keep row names as column, often help ful expr_df %&gt;% rownames_to_column(&quot;Sample&quot;) ## Sample BRCA1 TP53 EGFR ## 1 Sample_A 12.5 8.3 15.2 ## 2 Sample_B 13.1 9.0 14.8 ## 3 Sample_C 11.9 8.7 16.0 2.8 Introduction to ggplot2 ggplot2 is based on the Grammar of Graphics, which means plots are built by combining independent components. Core Components of a ggplot Data: the dataset you want to visualize Aesthetics (aes): how variables map to visual properties (x, y, color, size, etc.) Geometries (geom_*): the type of plot (points, lines, bars, boxes, …) Basic structure: # ggplot(data, aes(x = variable1, y = variable2)) + # geom_* 2.8.1 Basic Scatter Plot Relationship Between Two Variables Question answered: Are two numeric variables related? ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + geom_point() Adding Color and Labels ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width, color = Species)) + geom_point() + labs( title = &quot;Sepal Length vs Width&quot;, x = &quot;Sepal Length&quot;, y = &quot;Sepal Width&quot; ) # Use case (biology): # Comparing morphological measurements across species groups. 2.8.2 Scatter Plot with Trend Line Question answered: Is there an overall trend or correlation? ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + geom_point() + geom_smooth(method = &quot;lm&quot;, se = FALSE) ## `geom_smooth()` using formula = &#39;y ~ x&#39; # what if we fit regression group wise ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width, color = Species)) + geom_point() + geom_smooth(method = &quot;lm&quot;, se = FALSE) ## `geom_smooth()` using formula = &#39;y ~ x&#39; # combine group and overall trend ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + geom_point() + geom_smooth(method = &quot;lm&quot;, se = FALSE, color = &quot;black&quot;) + geom_smooth( aes(color = Species), method = &quot;lm&quot;, se = FALSE ) ## `geom_smooth()` using formula = &#39;y ~ x&#39; ## `geom_smooth()` using formula = &#39;y ~ x&#39; # In biological data, different groups (species, treatments, conditions) often show different relationships. # Grouped regression lines help reveal these group-specific patterns. 2.8.3 Boxplots Compare Distributions Across Groups Question answered: How does a numeric variable differ between groups? ggplot(iris, aes(x = Species, y = Sepal.Length, fill = Species)) + geom_boxplot() # Use case (biology): # Comparing gene expression, cell size, or phenotype across conditions. 2.8.4 Histograms Distribution of a Single Variable Question answered: How is a variable distributed? ggplot(iris, aes(x = Sepal.Length)) + geom_histogram(bins = 20) # histogram by group ggplot(iris, aes(x = Sepal.Length, fill = Species)) + geom_histogram(bins = 20, alpha = 0.6) 2.8.5 Density Plots Smooth Distribution Comparing distributions without binning effects. ggplot(iris, aes(x = Sepal.Length)) + geom_density() # by group ggplot(iris, aes(x = Sepal.Length, color = Species)) + geom_density() Violin Plots Distribution Shape + Spread (density plot or histogram + boxplot) ggplot(iris, aes(x = Species, y = Sepal.Length, fill = Species)) + geom_violin(trim = FALSE) Bar Plots Counts and Summaries Count of Observations per Group ggplot(iris, aes(x = Species)) + geom_bar() ggplot(iris, aes(x = Species, y = Sepal.Length, fill = Species)) + stat_summary(fun = mean, geom = &quot;bar&quot;) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;, width = 0.2) Line Plots Trends Over Time Example: simulated time-course data time_course &lt;- tibble( Time = c(0, 6, 12), Expression = c(5.2, 8.1, 12.4) ) ggplot(time_course, aes(x = Time, y = Expression)) + geom_line() + geom_point() # Gene expression over time or treatment duration. Faceting (Multiple Plots by Group) ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + geom_point() + facet_wrap(~ Species) # Use case: # Compare patterns across experimental conditions side-by-side. 2.8.6 Venn Diagrams Used for: Overlap of genes between experiments Shared pathways Common differentially expressed genes # if (!require(devtools)) install.packages(&quot;devtools&quot;) # devtools::install_github(&quot;yanlinlin82/ggvenn&quot;) set.seed(20190708) genes &lt;- paste(&quot;gene&quot;,1:1000,sep=&quot;&quot;) x &lt;- list( A = sample(genes,300), B = sample(genes,525), C = sample(genes,440), D = sample(genes,350) ) library(ggvenn) ggvenn( x, fill_color = c(&quot;#0073C2FF&quot;, &quot;#EFC000FF&quot;, &quot;#868686FF&quot;, &quot;#CD534CFF&quot;), stroke_size = 0.5, set_name_size = 4 ) library(pheatmap) # Create a hypothetical gene expression matrix expression_matrix &lt;- matrix( c( 8.2, 6.1, 7.4, 5.9, 3.2, 2.8, 3.5, 2.9, 10.5, 11.2, 9.8, 10.1, 4.6, 5.1, 4.8, 5.3, 7.9, 8.4, 8.1, 8.7 ), nrow = 5, byrow = TRUE ) # Add gene names (rows) rownames(expression_matrix) &lt;- c( &quot;BRCA1&quot;, &quot;TP53&quot;, &quot;EGFR&quot;, &quot;MYC&quot;, &quot;CDKN1A&quot; ) # Add sample names (columns) colnames(expression_matrix) &lt;- c( &quot;Sample_1&quot;, &quot;Sample_2&quot;, &quot;Sample_3&quot;, &quot;Sample_4&quot; ) expression_matrix ## Sample_1 Sample_2 Sample_3 Sample_4 ## BRCA1 8.2 6.1 7.4 5.9 ## TP53 3.2 2.8 3.5 2.9 ## EGFR 10.5 11.2 9.8 10.1 ## MYC 4.6 5.1 4.8 5.3 ## CDKN1A 7.9 8.4 8.1 8.7 pheatmap(expression_matrix, cluster_rows = FALSE, cluster_cols = FALSE) pheatmap(expression_matrix) Combining dplyr and ggplot2 iris %&gt;% filter(Species != &quot;setosa&quot;) %&gt;% ggplot(aes(x = Petal.Length, y = Petal.Width, color = Species)) + geom_point() 2.9 Exploratory Data Analysis (EDA) Exploratory Data Analysis (EDA) is the process of examining and summarizing data to understand its main characteristics before applying formal statistical models. EDA relies heavily on visualization and simple summaries, rather than statistical tests. Why EDA is important EDA helps you to: Understand the structure and shape of the data Detect outliers and unusual observations Identify patterns and relationships Compare groups Assess data quality Generate hypotheses for further analysis 2.9.1 Understanding the Structure of the Data Before any analysis, always inspect the data. summary(iris) ## Sepal.Length Sepal.Width Petal.Length Petal.Width ## Min. :4.300 Min. :2.000 Min. :1.000 Min. :0.100 ## 1st Qu.:5.100 1st Qu.:2.800 1st Qu.:1.600 1st Qu.:0.300 ## Median :5.800 Median :3.000 Median :4.350 Median :1.300 ## Mean :5.843 Mean :3.057 Mean :3.758 Mean :1.199 ## 3rd Qu.:6.400 3rd Qu.:3.300 3rd Qu.:5.100 3rd Qu.:1.800 ## Max. :7.900 Max. :4.400 Max. :6.900 Max. :2.500 ## Species ## setosa :50 ## versicolor:50 ## virginica :50 ## ## ## This helps answer: What variables are present? Are they numeric or categorical? Are ranges reasonable? 2.9.2 Checking for Missing Values colSums(is.na(iris)) ## Sepal.Length Sepal.Width Petal.Length Petal.Width Species ## 0 0 0 0 0 # can you write this in tidyverse way? 2.9.3 Understanding Distributions Histogram (distribution of a numeric variable) ggplot(iris, aes(x = Sepal.Length)) + geom_histogram(bins = 30) + labs( title = &quot;Distribution of Sepal Length&quot;, x = &quot;Sepal Length&quot;, y = &quot;Count&quot; ) Questions to ask: Is the distribution symmetric or skewed? Are there extreme values? 2.9.4 Identifying Outliers ggplot(iris, aes(y = Sepal.Length)) + geom_boxplot() + labs( title = &quot;Boxplot of Sepal Length&quot;, y = &quot;Sepal Length&quot; ) Boxplots are useful for spotting: Outliers Spread of the data Median values 2.9.5 Comparing Groups Boxplot by group ggplot(iris, aes(x = Species, y = Sepal.Length, fill = Species)) + geom_boxplot() + labs( title = &quot;Sepal Length by Species&quot;, x = &quot;Species&quot;, y = &quot;Sepal Length&quot; ) This helps answer: Do groups differ in central tendency? Is variability similar across groups? 2.9.6 Exploring Relationships Between Variables Scatter plot ggplot(iris, aes(x = Petal.Length, y = Petal.Width)) + geom_point() + labs( title = &quot;Petal Length vs Petal Width&quot;, x = &quot;Petal Length&quot;, y = &quot;Petal Width&quot; ) Scatter plot with grouping ggplot(iris, aes(x = Petal.Length, y = Petal.Width, color = Species)) + geom_point() + labs( title = &quot;Petal Length vs Petal Width by Species&quot; ) Questions to ask: Are variables related? Do relationships differ by group? 2.9.7 Simple Group Summaries iris %&gt;% group_by(Species) %&gt;% summarise( mean_sepal_length = mean(Sepal.Length), sd_sepal_length = sd(Sepal.Length) ) ## # A tibble: 3 × 3 ## Species mean_sepal_length sd_sepal_length ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 setosa 5.01 0.352 ## 2 versicolor 5.94 0.516 ## 3 virginica 6.59 0.636 These summaries describe patterns, not statistical significance. 2.9.8 EDA vs Statistical Analysis EDA answers: What does the data look like? Statistical analysis answers: Are the observed differences statistically significant? Formal hypothesis testing will be covered in week-3 in Statistics sessions. Will give introduction in next session from prospect of analysis. Good EDA helps you: Understand your data Avoid incorrect assumptions Ask better scientific questions 2.10 Hands-on Exercises 2.10.1 Exercise 1 Using iris dataset: Filter only versicolor Select Sepal.Length and Petal.Length 2.10.2 Exercise 2 Create a new column: Petal.ratio = Petal.Length to Petal.Width 2.10.3 Exercise 3 Create a plot: X-axis: Petal.Length Y-axis: Petal.Width Color by Species 2.10.4 Exercise 4 (Challenge) Calculate mean Sepal.Length for each species and visualize it using a bar plot. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
