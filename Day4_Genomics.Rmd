# Day-4 : Genomic Data Exploration Using R - 1 

## Learning Objectives

By the end of this day, students will be able to:

- Understand common genomic data types
- Learn what Bioconductor is and why it is used
- Work with expression data in R
- Use Bioconductor data structures
- Perform basic exploratory analysis on genomic datasets

---

## What Is Genomic Data?

Genomic data refers to information derived from DNA, RNA, or related molecules.

Common genomic data types include:

- **Gene expression data** (RNA-seq, microarrays)
- **Genomic coordinates** (BED, GFF, GRanges)
- **Variant data** (VCF)
- **Annotation data** (gene names, pathways)

In this course, we focus on **gene expression data**.

---

## What Is Bioconductor?

**Bioconductor** is a collection of R packages designed for:

- Genomic data analysis
- Biological annotation
- Reproducible research

Key features:

- Standardized data structures
- Well-documented packages
- Strong integration with R statistics

Bioconductor complements CRAN.

---

## Installing Bioconductor

Install Bioconductor (only once):

```{r, eval=FALSE}

# install.packages("BiocManager") [unhash it for first run]

# BiocManager::install() [unhash it for first run]

```

Install required packages:

```{r}

# BiocManager::install(c("SummarizedExperiment", "airway", "Biobase")) [unhash it for first run]

```

Loading Required Libraries

```{r}
library(SummarizedExperiment)
library(airway)
library(Biobase)
library(dplyr)
library(ggplot2)
library(DESeq2)

```

Example Dataset: airway

The airway dataset contains RNA-seq gene expression data from an experiment
studying the effect of dexamethasone on human airway smooth muscle cells.

What Kind of Data Is This?

- The airway dataset contains raw RNA-seq count data.

- Each value represents the number of sequencing reads mapped to a gene

- Values are integers

- Data is not normalized

- Data is not log-transformed

Load the dataset:

```{r}
data(airway)
airway

```

Understanding SummarizedExperiment

SummarizedExperiment is a core Bioconductor data structure.

It contains:

- assay data – expression matrix

- rowData – gene-level information

- colData – sample-level metadata

Exploring the Expression Data
Assay Data (Counts Matrix)

```{r}

assay(airway)[1:5, 1:5]

```

Dimensions:

```{r}

dim(assay(airway))

```

Sample Metadata (colData)

```{r}
colData(airway)

```

Convert to data frame:

```{r}
sample_info <- as.data.frame(colData(airway))
head(sample_info)

```

Gene Metadata (rowData)

```{r}
rowData(airway)

```


Basic Quality Checks
Library Sizes

```{r}
library_sizes <- colSums(assay(airway))
library_sizes

```

Visualize library sizes:

```{r}

ggplot(data.frame(library_sizes), aes(x = library_sizes)) +
geom_histogram(bins = 10, fill = "steelblue") +
labs(
title = "Library Size Distribution",
x = "Total Read Counts",
y = "Number of Samples"
)

```



```{r}
counts <- assay(airway)

hist(counts[, 1],
breaks = 50,
main = "Distribution of Raw Counts (Sample 1)",
xlab = "Read Counts")

```

### Log Transformation for Exploration

- Raw counts are highly skewed.
- For visualization only, we use a log transformation:

```{r}

log_counts <- log2(counts + 1)

hist(log_counts[, 1],
breaks = 50,
main = "Log-transformed Counts (Sample 1)",
xlab = "log2(count + 1)")

```



```{r}
group <- colData(airway)$dex
group

```

```{r}
boxplot(
log_counts,
col = ifelse(group == "trt", "tomato", "lightblue"),
las = 2,
main = "Log-transformed Expression Values"
)

```

### Differential Expression Analysis (Conceptual)

- We now demonstrate how genomic analyses are typically performed using a specialized package.

```{r}

dds <- DESeqDataSet(
airway,
design = ~ dex
)

```

```{r}
dds <- DESeq(dds)

res <- results(dds)

head(res)

```

```{r}

res_df <- as.data.frame(res)
res_df$gene <- rownames(res_df)

sig_genes <- res_df %>%
filter(padj < 0.05, abs(log2FoldChange) > 1)

nrow(sig_genes)
head(sig_genes)

```

### Volcano Plot

- A volcano plot shows both effect size and significance.

```{r}

ggplot(res_df, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(alpha = 0.4) +
geom_vline(xintercept = c(-1, 1), linetype = "dashed") +
geom_hline(yintercept = -log10(0.05), linetype = "dashed") +
labs(
title = "Volcano Plot",
x = "Log2 Fold Change",
y = "-log10(p-value)"
)

```

- we can add colors based on up-regulation and down-regulation.

```{r}
res_df <- res_df %>%
  mutate(
    regulation = case_when(
      padj < 0.05 & log2FoldChange > 1  ~ "Up-regulated",
      padj < 0.05 & log2FoldChange < -1 ~ "Down-regulated",
      TRUE                             ~ "Not significant"
    )
  )

ggplot(res_df, aes(x = log2FoldChange, y = -log10(pvalue), color = regulation)) +
  geom_point(alpha = 0.6, size = 0.25) +
  geom_vline(xintercept = c(-1, 1), linetype = "dashed") +
  geom_hline(yintercept = -log10(0.05), linetype = "dashed") +
  scale_color_manual(
    values = c(
      "Up-regulated" = "red",
      "Down-regulated" = "blue",
      "Not significant" = "grey"
    )
  ) +
  labs(
    title = "Volcano Plot of Differential Gene Expression",
    x = "Log2 Fold Change",
    y = "-log10(p-value)",
    color = "Gene Regulation"
  ) +
  theme_minimal()

```

- adding the labels for top most significant genes. 

```{r}
library(ggrepel)

top_genes <- res_df %>%
  filter(regulation != "Not significant") %>%
  arrange(padj) %>%
  head(10)

ggplot(res_df, aes(log2FoldChange, -log10(pvalue), color = regulation)) +
  geom_point(alpha = 0.6, size = 0.5) +
  geom_text_repel(
    data = top_genes,
    aes(label = gene),
    size = 3
  ) +
  geom_vline(xintercept = c(-1, 1), linetype = "dashed") +
  geom_hline(yintercept = -log10(0.05), linetype = "dashed") +
  scale_color_manual(
    values = c("Up-regulated" = "red",
               "Down-regulated" = "blue",
               "Not significant" = "grey")
  ) +
  theme_minimal()

```

